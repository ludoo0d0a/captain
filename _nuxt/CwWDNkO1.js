import{f as D,j as z,r as c,G as F,n as M,c as l,a,b as W,w as G,B as H,p as f,E as g,F as y,s as C,H as A,x,e as Q,o as n,t as L,D as S}from"./D68jn0To.js";const R={class:"w-full min-h-screen bg-gray-50 p-8"},q={class:"flex items-center mb-8"},J={key:0,class:"flex justify-center items-center min-h-[200px]"},O={key:1,class:"bg-white rounded shadow p-6"},P={class:"flex items-center mb-4"},X={class:"divide-y mb-4"},Y=["onKeyup"],Z={key:1,class:"flex-1"},ee={key:2,class:"relative w-48"},te=["onKeyup"],se={key:0,class:"absolute z-10 bg-white border rounded shadow mt-1 w-full max-h-32 overflow-auto"},oe=["onMousedown"],le={key:0,class:"inline-block text-gray-400 text-xs"},ne=["onClick"],ae=["onClick"],ie=["onClick"],re={class:"flex gap-2 mb-2 items-start"},ue={class:"relative w-48"},de={key:0,class:"absolute z-10 bg-white border rounded shadow mt-1 w-full max-h-32 overflow-auto"},ce=["onMousedown"],xe=D({__name:"manage-applications",setup(pe){const r=z(),v=c([]),w=c(""),d=c(""),p=c(""),m=c(""),u=c(""),h=c("");F(async()=>{await r.fetchApplications(),v.value=r.applications});const b=M(()=>{const s=new Set;return v.value.forEach(e=>(e.tags||[]).forEach(o=>s.add(o))),Array.from(s).sort()}),E=M(()=>{if(!h.value.trim())return v.value;const s=h.value.trim().toLowerCase();return v.value.filter(e=>e.name.toLowerCase().includes(s)||e.tags&&e.tags.some(o=>o.toLowerCase().includes(s)))}),_=c([]);function N(){var e;const s=((e=d.value.split(",").pop())==null?void 0:e.trim().toLowerCase())||"";_.value=s?b.value.filter(o=>o.toLowerCase().startsWith(s)&&!d.value.split(",").map(t=>t.trim().toLowerCase()).includes(o.toLowerCase())):b.value.filter(o=>!d.value.split(",").map(t=>t.trim().toLowerCase()).includes(o.toLowerCase()))}function V(s){let e=d.value.split(",").map(o=>o.trim()).filter(Boolean);e.includes(s)||e.push(s),d.value=e.join(", ")+", ",_.value=[]}const k=c([]);function I(){var e;const s=((e=u.value.split(",").pop())==null?void 0:e.trim().toLowerCase())||"";k.value=s?b.value.filter(o=>o.toLowerCase().startsWith(s)&&!u.value.split(",").map(t=>t.trim().toLowerCase()).includes(o.toLowerCase())):b.value.filter(o=>!u.value.split(",").map(t=>t.trim().toLowerCase()).includes(o.toLowerCase()))}function K(s){let e=u.value.split(",").map(o=>o.trim()).filter(Boolean);e.includes(s)||e.push(s),u.value=e.join(", ")+", ",k.value=[]}async function T(){if(!w.value.trim())return;const s=d.value.split(",").map(e=>e.trim()).filter(Boolean);await r.addApplication({id:"app-"+Math.random().toString(36).slice(2),name:w.value.trim(),versions:[],tags:s}),await r.fetchApplications(),v.value=r.applications,w.value="",d.value=""}function $(s){p.value=s.id,m.value=s.name,u.value=(s.tags||[]).join(", ")}async function B(s){if(!m.value.trim())return;const e=u.value.split(",").map(o=>o.trim()).filter(Boolean);await r.updateApplication(s.id,{name:m.value.trim(),tags:e}),await r.fetchApplications(),v.value=r.applications,p.value="",m.value="",u.value=""}function j(){p.value="",m.value="",u.value=""}async function U(s){await r.removeApplication(s),await r.fetchApplications(),v.value=r.applications}return(s,e)=>{const o=Q;return n(),l("div",R,[a("div",q,[W(o,{to:"/",class:"mr-4"},{default:G(()=>e[5]||(e[5]=[a("button",{class:"p-2 rounded hover:bg-gray-100",title:"Back to Applications"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})])],-1)])),_:1,__:[5]}),e[6]||(e[6]=a("h1",{class:"text-3xl font-bold"},"Manage Applications",-1))]),H(r).loading?(n(),l("div",J,e[7]||(e[7]=[a("svg",{class:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[a("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),a("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):(n(),l("div",O,[a("div",P,[e[8]||(e[8]=a("h3",{class:"text-xl font-semibold flex-1"},"Applications",-1)),f(a("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),class:"border rounded px-2 py-1 text-sm ml-4 w-64",placeholder:"Quick filter by name or tag"},null,512),[[g,h.value]])]),a("ul",X,[(n(!0),l(y,null,C(E.value,t=>(n(),l("li",{key:t.id,class:"py-3 flex items-center gap-2"},[p.value===t.id?f((n(),l("input",{key:0,"onUpdate:modelValue":e[1]||(e[1]=i=>m.value=i),class:"border rounded px-2 py-1 text-sm flex-1",onKeyup:A(i=>B(t),["enter"])},null,40,Y)),[[g,m.value]]):(n(),l("span",Z,L(t.name),1)),p.value===t.id?(n(),l("div",ee,[f(a("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>u.value=i),class:"border rounded px-2 py-1 text-xs w-full",placeholder:"Tags (comma separated)",onInput:I,onKeyup:A(i=>B(t),["enter"])},null,40,te),[[g,u.value]]),k.value.length?(n(),l("ul",se,[(n(!0),l(y,null,C(k.value,i=>(n(),l("li",{key:i,class:"px-2 py-1 text-xs cursor-pointer hover:bg-blue-100",onMousedown:S(ve=>K(i),["prevent"])},L(i),41,oe))),128))])):x("",!0)])):(n(),l(y,{key:3},[(n(!0),l(y,null,C(t.tags||[],i=>(n(),l("span",{key:i,class:"inline-block bg-gray-100 text-gray-700 text-xs rounded px-2 py-1 mr-1 min-w-[2.5rem] text-center"},L(i),1))),128)),!t.tags||!t.tags.length?(n(),l("span",le,"â€”")):x("",!0)],64)),p.value!==t.id?(n(),l("button",{key:4,class:"text-xs text-blue-600",onClick:i=>$(t)},"Rename/Tags",8,ne)):x("",!0),p.value===t.id?(n(),l("button",{key:5,class:"text-xs text-green-600",onClick:i=>B(t)},"Save",8,ae)):x("",!0),p.value===t.id?(n(),l("button",{key:6,class:"text-xs text-gray-500",onClick:j},"Cancel")):x("",!0),a("button",{class:"text-xs text-red-600",onClick:i=>U(t.id)},"Delete",8,ie)]))),128))]),a("div",re,[f(a("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),class:"border rounded px-2 py-1 text-sm flex-1",placeholder:"New application name",onKeyup:A(T,["enter"])},null,544),[[g,w.value]]),a("div",ue,[f(a("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>d.value=t),class:"border rounded px-2 py-1 text-xs w-full",placeholder:"Tags (comma separated)",onInput:N,onKeyup:A(T,["enter"])},null,544),[[g,d.value]]),_.value.length?(n(),l("ul",de,[(n(!0),l(y,null,C(_.value,t=>(n(),l("li",{key:t,class:"px-2 py-1 text-xs cursor-pointer hover:bg-blue-100",onMousedown:S(i=>V(t),["prevent"])},L(t),41,ce))),128))])):x("",!0)]),a("button",{class:"bg-blue-500 text-white px-3 py-1 rounded text-sm",onClick:T},"Add")])]))])}}});export{xe as default};
