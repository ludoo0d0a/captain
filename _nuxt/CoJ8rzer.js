import{f as V,g as D,h as A,i as C,j as c,r as S,c as a,o as l,a as s,d as v,t as f,k as h,v as B,l as E,F as M,m as N,n as T}from"./Ynf5fPIE.js";import{u as j}from"./C8vFggs1.js";import{u as q}from"./DRM8XXcm.js";import{u as F,a as R}from"./CnAt3jol.js";const U={class:"max-w-lg mx-auto mt-10 bg-white rounded shadow p-6"},L={key:0},O={class:"mb-2"},z={class:"mb-2"},G={class:"mb-4 flex items-center gap-4"},H={class:"mb-4"},J=["value"],K={key:0},P=["disabled"],Q={key:1,class:"text-red-500"},ee=V({__name:"deploy",setup(W){const y=D(),x=A(),b=C("showToast"),d=y.query.appId,i=y.query.envId,_=j(),w=q(),g=F(),r=R(),p=c(()=>_.applications.find(t=>t.id===d)),u=c(()=>w.environments.find(t=>t.id===i)),m=S(!1),n=S(""),k=c(()=>g.versions.filter(t=>t.appId===d&&(m.value||!t.isSnapshot)));function I(){if(!n.value||!p.value||!u.value)return;const t=new Date().toISOString(),e=r.deployments.find(o=>o.appId===d&&o.envId===i);e?r.updateDeployment(e.id,{versionId:n.value,status:"deployed",deployedAt:t}):r.addDeployment({id:"dep-"+Math.random().toString(36).slice(2),appId:d,envId:i,versionId:n.value,status:"deployed",deployedAt:t}),b&&b("Version deployed successfully!","success"),x.push("/")}return(t,e)=>(l(),a("div",U,[e[6]||(e[6]=s("h2",{class:"text-2xl font-bold mb-4"},"Deploy Version",-1)),p.value&&u.value?(l(),a("div",L,[s("div",O,[e[2]||(e[2]=s("span",{class:"font-semibold"},"App:",-1)),v(" "+f(p.value.name),1)]),s("div",z,[e[3]||(e[3]=s("span",{class:"font-semibold"},"Environment:",-1)),v(" "+f(u.value.name),1)]),s("div",G,[e[4]||(e[4]=s("label",{class:"font-medium"},"Show Snapshots",-1)),h(s("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>m.value=o)},null,512),[[B,m.value]])]),s("div",H,[e[5]||(e[5]=s("label",{class:"block mb-1 font-medium"},"Select Version",-1)),h(s("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),class:"w-full border rounded px-3 py-2"},[(l(!0),a(M,null,N(k.value,o=>(l(),a("option",{key:o.id,value:o.id},[v(f(o.name)+" ",1),o.isSnapshot?(l(),a("span",K,"(snapshot)")):T("",!0)],8,J))),128))],512),[[E,n.value]])]),s("button",{class:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 font-semibold",disabled:!n.value,onClick:I}," Deploy ",8,P)])):(l(),a("div",Q,"Invalid app or environment."))]))}});export{ee as default};
