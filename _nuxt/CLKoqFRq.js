import{f as z,k as A,r as c,G as F,n as M,c as o,a as l,b as W,w as G,B as H,p as f,E as g,F as y,s as E,H as C,x,e as Q,o as a,t as L,D as S}from"./D68jn0To.js";const R={class:"w-full min-h-screen bg-gray-50 p-8"},q={class:"flex items-center mb-8"},J={key:0,class:"flex justify-center items-center min-h-[200px]"},O={key:1,class:"bg-white rounded shadow p-6"},P={class:"flex items-center mb-4"},X={class:"divide-y mb-4"},Y=["onKeyup"],Z={key:1,class:"flex-1"},ee={key:2,class:"relative w-48"},te=["onKeyup"],ne={key:0,class:"absolute z-10 bg-white border rounded shadow mt-1 w-full max-h-32 overflow-auto"},se=["onMousedown"],oe={key:0,class:"inline-block text-gray-400 text-xs"},ae=["onClick"],le=["onClick"],ie=["onClick"],re={class:"flex gap-2 mb-2 items-start"},ue={class:"relative w-48"},de={key:0,class:"absolute z-10 bg-white border rounded shadow mt-1 w-full max-h-32 overflow-auto"},ce=["onMousedown"],xe=z({__name:"manage-environments",setup(ve){const r=A(),m=c([]),w=c(""),d=c(""),v=c(""),p=c(""),u=c(""),h=c("");F(async()=>{await r.fetchEnvironments(),m.value=r.environments});const b=M(()=>{const n=new Set;return m.value.forEach(e=>(e.tags||[]).forEach(s=>n.add(s))),Array.from(n).sort()}),N=M(()=>{if(!h.value.trim())return m.value;const n=h.value.trim().toLowerCase();return m.value.filter(e=>e.name.toLowerCase().includes(n)||e.tags&&e.tags.some(s=>s.toLowerCase().includes(n)))}),_=c([]);function V(){var e;const n=((e=d.value.split(",").pop())==null?void 0:e.trim().toLowerCase())||"";_.value=n?b.value.filter(s=>s.toLowerCase().startsWith(n)&&!d.value.split(",").map(t=>t.trim().toLowerCase()).includes(s.toLowerCase())):b.value.filter(s=>!d.value.split(",").map(t=>t.trim().toLowerCase()).includes(s.toLowerCase()))}function I(n){let e=d.value.split(",").map(s=>s.trim()).filter(Boolean);e.includes(n)||e.push(n),d.value=e.join(", ")+", ",_.value=[]}const k=c([]);function K(){var e;const n=((e=u.value.split(",").pop())==null?void 0:e.trim().toLowerCase())||"";k.value=n?b.value.filter(s=>s.toLowerCase().startsWith(n)&&!u.value.split(",").map(t=>t.trim().toLowerCase()).includes(s.toLowerCase())):b.value.filter(s=>!u.value.split(",").map(t=>t.trim().toLowerCase()).includes(s.toLowerCase()))}function $(n){let e=u.value.split(",").map(s=>s.trim()).filter(Boolean);e.includes(n)||e.push(n),u.value=e.join(", ")+", ",k.value=[]}async function T(){if(!w.value.trim())return;const n=d.value.split(",").map(e=>e.trim()).filter(Boolean);await r.addEnvironment({id:"env-"+Math.random().toString(36).slice(2),name:w.value.trim(),tags:n}),await r.fetchEnvironments(),m.value=r.environments,w.value="",d.value=""}function j(n){v.value=n.id,p.value=n.name,u.value=(n.tags||[]).join(", ")}async function B(n){if(!p.value.trim())return;const e=u.value.split(",").map(s=>s.trim()).filter(Boolean);await r.updateEnvironment(n.id,{name:p.value.trim(),tags:e}),await r.fetchEnvironments(),m.value=r.environments,v.value="",p.value="",u.value=""}function U(){v.value="",p.value="",u.value=""}async function D(n){await r.removeEnvironment(n),await r.fetchEnvironments(),m.value=r.environments}return(n,e)=>{const s=Q;return a(),o("div",R,[l("div",q,[W(s,{to:"/",class:"mr-4"},{default:G(()=>e[5]||(e[5]=[l("button",{class:"p-2 rounded hover:bg-gray-100",title:"Back to Environments"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})])],-1)])),_:1,__:[5]}),e[6]||(e[6]=l("h1",{class:"text-3xl font-bold"},"Manage Environments",-1))]),H(r).loading?(a(),o("div",J,e[7]||(e[7]=[l("svg",{class:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):(a(),o("div",O,[l("div",P,[e[8]||(e[8]=l("h3",{class:"text-xl font-semibold flex-1"},"Environments",-1)),f(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>h.value=t),class:"border rounded px-2 py-1 text-sm ml-4 w-64",placeholder:"Quick filter by name or tag"},null,512),[[g,h.value]])]),l("ul",X,[(a(!0),o(y,null,E(N.value,t=>(a(),o("li",{key:t.id,class:"py-3 flex items-center gap-2"},[v.value===t.id?f((a(),o("input",{key:0,"onUpdate:modelValue":e[1]||(e[1]=i=>p.value=i),class:"border rounded px-2 py-1 text-sm flex-1",onKeyup:C(i=>B(t),["enter"])},null,40,Y)),[[g,p.value]]):(a(),o("span",Z,L(t.name),1)),v.value===t.id?(a(),o("div",ee,[f(l("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>u.value=i),class:"border rounded px-2 py-1 text-xs w-full",placeholder:"Tags (comma separated)",onInput:K,onKeyup:C(i=>B(t),["enter"])},null,40,te),[[g,u.value]]),k.value.length?(a(),o("ul",ne,[(a(!0),o(y,null,E(k.value,i=>(a(),o("li",{key:i,class:"px-2 py-1 text-xs cursor-pointer hover:bg-blue-100",onMousedown:S(me=>$(i),["prevent"])},L(i),41,se))),128))])):x("",!0)])):(a(),o(y,{key:3},[(a(!0),o(y,null,E(t.tags||[],i=>(a(),o("span",{key:i,class:"inline-block bg-gray-100 text-gray-700 text-xs rounded px-2 py-1 mr-1 min-w-[2.5rem] text-center"},L(i),1))),128)),!t.tags||!t.tags.length?(a(),o("span",oe,"â€”")):x("",!0)],64)),v.value!==t.id?(a(),o("button",{key:4,class:"text-xs text-blue-600",onClick:i=>j(t)},"Rename/Tags",8,ae)):x("",!0),v.value===t.id?(a(),o("button",{key:5,class:"text-xs text-green-600",onClick:i=>B(t)},"Save",8,le)):x("",!0),v.value===t.id?(a(),o("button",{key:6,class:"text-xs text-gray-500",onClick:U},"Cancel")):x("",!0),l("button",{class:"text-xs text-red-600",onClick:i=>D(t.id)},"Delete",8,ie)]))),128))]),l("div",re,[f(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>w.value=t),class:"border rounded px-2 py-1 text-sm flex-1",placeholder:"New environment name",onKeyup:C(T,["enter"])},null,544),[[g,w.value]]),l("div",ue,[f(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>d.value=t),class:"border rounded px-2 py-1 text-xs w-full",placeholder:"Tags (comma separated)",onInput:V,onKeyup:C(T,["enter"])},null,544),[[g,d.value]]),_.value.length?(a(),o("ul",de,[(a(!0),o(y,null,E(_.value,t=>(a(),o("li",{key:t,class:"px-2 py-1 text-xs cursor-pointer hover:bg-blue-100",onMousedown:S(i=>I(t),["prevent"])},L(t),41,ce))),128))])):x("",!0)]),l("button",{class:"bg-blue-500 text-white px-3 py-1 rounded text-sm",onClick:T},"Add")])]))])}}});export{xe as default};
