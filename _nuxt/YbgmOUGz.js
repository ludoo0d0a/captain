import{e as T,f as q,h as A,j as B,k as E,l as M,m as l,r as _,c as n,a as o,d as c,t as i,n as g,v as N,p as j,F as w,q as F,g as R,i as U,o as a,s as x}from"./XM21gfKi.js";const L={class:"max-w-lg mx-auto mt-10 bg-white rounded shadow p-6"},O={key:0},z={class:"mb-2"},G={class:"mb-2"},H={class:"mb-4 flex items-center gap-4"},J={class:"mb-4"},K=["value"],Q={key:0},W=["disabled"],X={key:1,class:"text-red-500"},$=T({__name:"promote",setup(Y){const f=q(),k=R(),b=U("showToast"),d=f.query.appId,u=f.query.envId,I=A(),S=B(),V=E(),y=M(),p=l(()=>I.applications.find(e=>e.id===d)),v=l(()=>S.environments.find(e=>e.id===u)),m=_(!1),r=_(""),D=l(()=>y.deployments.filter(e=>e.appId===d&&e.envId!==u).map(e=>({env:S.environments.find(s=>s.id===e.envId),version:V.versions.find(s=>s.id===e.versionId)})).filter(e=>e.env&&e.version)),C=l(()=>D.value.filter(e=>e.version&&(m.value||!e.version.isSnapshot)));function P(){if(!r.value||!p.value||!v.value)return;const e=new Date().toISOString();y.addDeployment({id:"dep-"+Math.random().toString(36).slice(2),appId:d,envId:u,versionId:r.value,status:"deployed",deployedAt:e}),b&&b("Version promoted successfully!","success"),k.push("/")}return(e,s)=>(a(),n("div",L,[s[6]||(s[6]=o("h2",{class:"text-2xl font-bold mb-4"},"Promote Version",-1)),p.value&&v.value?(a(),n("div",O,[o("div",z,[s[2]||(s[2]=o("span",{class:"font-semibold"},"App:",-1)),c(" "+i(p.value.name),1)]),o("div",G,[s[3]||(s[3]=o("span",{class:"font-semibold"},"Target Environment:",-1)),c(" "+i(v.value.name),1)]),o("div",H,[s[4]||(s[4]=o("label",{class:"font-medium"},"Show Snapshots",-1)),g(o("input",{type:"checkbox","onUpdate:modelValue":s[0]||(s[0]=t=>m.value=t)},null,512),[[N,m.value]])]),o("div",J,[s[5]||(s[5]=o("label",{class:"block mb-1 font-medium"},"Select Version to Promote",-1)),g(o("select",{"onUpdate:modelValue":s[1]||(s[1]=t=>r.value=t),class:"w-full border rounded px-3 py-2"},[(a(!0),n(w,null,F(C.value,t=>{var h;return a(),n(w,{key:(h=t.version)==null?void 0:h.id},[t.env&&t.version?(a(),n("option",{key:0,value:t.version.id},[c(i(t.version.name)+" from "+i(t.env.name)+" ",1),t.version.isSnapshot?(a(),n("span",Q,"(snapshot)")):x("",!0)],8,K)):x("",!0)],64)}),128))],512),[[j,r.value]])]),o("button",{class:"w-full bg-green-600 text-white py-2 rounded hover:bg-green-700 font-semibold",disabled:!r.value,onClick:P}," Promote ",8,W)])):(a(),n("div",X,"Invalid app or environment."))]))}});export{$ as default};
