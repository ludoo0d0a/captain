import{e as V,f as D,g as A,i as C,h as q,j as B,k as E,l as M,m,r as S,c as l,o as a,a as s,d as v,t as f,n as h,v as N,p as T,F as j,q as F,s as R}from"./XM21gfKi.js";const U={class:"max-w-lg mx-auto mt-10 bg-white rounded shadow p-6"},L={key:0},O={class:"mb-2"},z={class:"mb-2"},G={class:"mb-4 flex items-center gap-4"},H={class:"mb-4"},J=["value"],K={key:0},P=["disabled"],Q={key:1,class:"text-red-500"},Y=V({__name:"deploy",setup(W){const y=D(),x=A(),b=C("showToast"),d=y.query.appId,i=y.query.envId,_=q(),w=B(),g=E(),r=M(),p=m(()=>_.applications.find(t=>t.id===d)),u=m(()=>w.environments.find(t=>t.id===i)),c=S(!1),n=S(""),k=m(()=>g.versions.filter(t=>t.appId===d&&(c.value||!t.isSnapshot)));function I(){if(!n.value||!p.value||!u.value)return;const t=new Date().toISOString(),e=r.deployments.find(o=>o.appId===d&&o.envId===i);e?r.updateDeployment(e.id,{versionId:n.value,status:"deployed",deployedAt:t}):r.addDeployment({id:"dep-"+Math.random().toString(36).slice(2),appId:d,envId:i,versionId:n.value,status:"deployed",deployedAt:t}),b&&b("Version deployed successfully!","success"),x.push("/")}return(t,e)=>(a(),l("div",U,[e[6]||(e[6]=s("h2",{class:"text-2xl font-bold mb-4"},"Deploy Version",-1)),p.value&&u.value?(a(),l("div",L,[s("div",O,[e[2]||(e[2]=s("span",{class:"font-semibold"},"App:",-1)),v(" "+f(p.value.name),1)]),s("div",z,[e[3]||(e[3]=s("span",{class:"font-semibold"},"Environment:",-1)),v(" "+f(u.value.name),1)]),s("div",G,[e[4]||(e[4]=s("label",{class:"font-medium"},"Show Snapshots",-1)),h(s("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>c.value=o)},null,512),[[N,c.value]])]),s("div",H,[e[5]||(e[5]=s("label",{class:"block mb-1 font-medium"},"Select Version",-1)),h(s("select",{"onUpdate:modelValue":e[1]||(e[1]=o=>n.value=o),class:"w-full border rounded px-3 py-2"},[(a(!0),l(j,null,F(k.value,o=>(a(),l("option",{key:o.id,value:o.id},[v(f(o.name)+" ",1),o.isSnapshot?(a(),l("span",K,"(snapshot)")):R("",!0)],8,J))),128))],512),[[T,n.value]])]),s("button",{class:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 font-semibold",disabled:!n.value,onClick:I}," Deploy ",8,P)])):(a(),l("div",Q,"Invalid app or environment."))]))}});export{Y as default};
