import{f as F,C as H,r as p,D as W,j as S,c as s,a as l,b as Q,w as q,y as N,k as x,B as g,F as h,m as C,E as A,n as m,e as G,o as n,t as L,A as E}from"./Ynf5fPIE.js";import{u as J}from"./C8vFggs1.js";const O={class:"w-full min-h-screen bg-gray-50 p-8"},P={class:"flex items-center mb-8"},X={key:0,class:"flex justify-center items-center min-h-[200px]"},Y={key:1,class:"bg-white rounded shadow p-6"},Z={class:"flex items-center mb-4"},ee=["disabled"],te={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},oe={key:1,class:"animate-spin h-5 w-5 text-blue-600",fill:"none",viewBox:"0 0 24 24"},se={class:"divide-y mb-4"},le=["onKeyup"],ne={key:1,class:"flex-1"},ae={key:2,class:"relative w-48"},ie=["onKeyup"],re={key:0,class:"absolute z-10 bg-white border rounded shadow mt-1 w-full max-h-32 overflow-auto"},ue=["onMousedown"],de={key:0,class:"inline-block text-gray-400 text-xs"},ce=["onClick"],pe=["onClick"],ve=["onClick"],me={class:"flex gap-2 mb-2 items-start"},we={class:"relative w-48"},fe={key:0,class:"absolute z-10 bg-white border rounded shadow mt-1 w-full max-h-32 overflow-auto"},xe=["onMousedown"],be=F({__name:"manage-applications",setup(ge){const u=J(),{applications:w,loading:M}=H(u),f=p(""),d=p(""),c=p(""),v=p(""),r=p(""),y=p("");W(async()=>{console.log("Applications page onMounted called"),await u.fetchApplications(),console.log("Applications loaded:",w.value.length)}),w.value.length===0&&(console.log("No applications found, fetching..."),u.fetchApplications());const k=S(()=>{const o=new Set;return w.value.forEach(e=>(e.tags||[]).forEach(a=>o.add(a))),Array.from(o).sort()}),V=S(()=>{if(!y.value.trim())return w.value;const o=y.value.trim().toLowerCase();return w.value.filter(e=>e.name.toLowerCase().includes(o)||e.tags&&e.tags.some(a=>a.toLowerCase().includes(o)))}),b=p([]);function j(){var e;const o=((e=d.value.split(",").pop())==null?void 0:e.trim().toLowerCase())||"";b.value=o?k.value.filter(a=>a.toLowerCase().startsWith(o)&&!d.value.split(",").map(t=>t.trim().toLowerCase()).includes(a.toLowerCase())):k.value.filter(a=>!d.value.split(",").map(t=>t.trim().toLowerCase()).includes(a.toLowerCase()))}function I(o){let e=d.value.split(",").map(a=>a.trim()).filter(Boolean);e.includes(o)||e.push(o),d.value=e.join(", ")+", ",b.value=[]}const _=p([]);function K(){var e;const o=((e=r.value.split(",").pop())==null?void 0:e.trim().toLowerCase())||"";_.value=o?k.value.filter(a=>a.toLowerCase().startsWith(o)&&!r.value.split(",").map(t=>t.trim().toLowerCase()).includes(a.toLowerCase())):k.value.filter(a=>!r.value.split(",").map(t=>t.trim().toLowerCase()).includes(a.toLowerCase()))}function $(o){let e=r.value.split(",").map(a=>a.trim()).filter(Boolean);e.includes(o)||e.push(o),r.value=e.join(", ")+", ",_.value=[]}async function T(){if(!f.value.trim())return;const o=d.value.split(",").map(e=>e.trim()).filter(Boolean);await u.addApplication({id:"app-"+Math.random().toString(36).slice(2),name:f.value.trim(),versions:[],tags:o}),await u.fetchApplications(),f.value="",d.value=""}function U(o){c.value=o.id,v.value=o.name,r.value=(o.tags||[]).join(", ")}async function B(o){if(!v.value.trim())return;const e=r.value.split(",").map(a=>a.trim()).filter(Boolean);await u.updateApplication(o.id,{name:v.value.trim(),tags:e}),await u.fetchApplications(),c.value="",v.value="",r.value=""}function z(){c.value="",v.value="",r.value=""}async function D(o){await u.removeApplication(o),await u.fetchApplications()}async function R(){await u.fetchApplications()}return(o,e)=>{const a=G;return n(),s("div",O,[l("div",P,[Q(a,{to:"/",class:"mr-4"},{default:q(()=>e[5]||(e[5]=[l("button",{class:"p-2 rounded hover:bg-gray-100",title:"Back to Applications"},[l("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6 text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})])],-1)])),_:1,__:[5]}),e[6]||(e[6]=l("h1",{class:"text-3xl font-bold"},"Manage Applications",-1))]),N(M)?(n(),s("div",X,e[7]||(e[7]=[l("svg",{class:"animate-spin h-8 w-8 text-blue-500",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"})],-1)]))):(n(),s("div",Y,[l("div",Z,[e[10]||(e[10]=l("h3",{class:"text-xl font-semibold flex-1"},"Applications",-1)),x(l("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>y.value=t),class:"border rounded px-2 py-1 text-sm ml-4 w-64",placeholder:"Quick filter by name or tag"},null,512),[[g,y.value]]),l("button",{onClick:R,disabled:N(M),class:"ml-2 p-2 rounded hover:bg-gray-100 disabled:opacity-50",title:"Refresh applications"},[N(M)?(n(),s("svg",oe,e[9]||(e[9]=[l("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),l("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8v8z"},null,-1)]))):(n(),s("svg",te,e[8]||(e[8]=[l("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"},null,-1)])))],8,ee)]),l("ul",se,[(n(!0),s(h,null,C(V.value,t=>(n(),s("li",{key:t.id,class:"py-3 flex items-center gap-2"},[c.value===t.id?x((n(),s("input",{key:0,"onUpdate:modelValue":e[1]||(e[1]=i=>v.value=i),class:"border rounded px-2 py-1 text-sm flex-1",onKeyup:A(i=>B(t),["enter"])},null,40,le)),[[g,v.value]]):(n(),s("span",ne,L(t.name),1)),c.value===t.id?(n(),s("div",ae,[x(l("input",{"onUpdate:modelValue":e[2]||(e[2]=i=>r.value=i),class:"border rounded px-2 py-1 text-xs w-full",placeholder:"Tags (comma separated)",onInput:K,onKeyup:A(i=>B(t),["enter"])},null,40,ie),[[g,r.value]]),_.value.length?(n(),s("ul",re,[(n(!0),s(h,null,C(_.value,i=>(n(),s("li",{key:i,class:"px-2 py-1 text-xs cursor-pointer hover:bg-blue-100",onMousedown:E(he=>$(i),["prevent"])},L(i),41,ue))),128))])):m("",!0)])):(n(),s(h,{key:3},[(n(!0),s(h,null,C(t.tags||[],i=>(n(),s("span",{key:i,class:"inline-block bg-gray-100 text-gray-700 text-xs rounded px-2 py-1 mr-1 min-w-[2.5rem] text-center"},L(i),1))),128)),!t.tags||!t.tags.length?(n(),s("span",de,"â€”")):m("",!0)],64)),c.value!==t.id?(n(),s("button",{key:4,class:"text-xs text-blue-600",onClick:i=>U(t)},"Rename/Tags",8,ce)):m("",!0),c.value===t.id?(n(),s("button",{key:5,class:"text-xs text-green-600",onClick:i=>B(t)},"Save",8,pe)):m("",!0),c.value===t.id?(n(),s("button",{key:6,class:"text-xs text-gray-500",onClick:z},"Cancel")):m("",!0),l("button",{class:"text-xs text-red-600",onClick:i=>D(t.id)},"Delete",8,ve)]))),128))]),l("div",me,[x(l("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>f.value=t),class:"border rounded px-2 py-1 text-sm flex-1",placeholder:"New application name",onKeyup:A(T,["enter"])},null,544),[[g,f.value]]),l("div",we,[x(l("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>d.value=t),class:"border rounded px-2 py-1 text-xs w-full",placeholder:"Tags (comma separated)",onInput:j,onKeyup:A(T,["enter"])},null,544),[[g,d.value]]),b.value.length?(n(),s("ul",fe,[(n(!0),s(h,null,C(b.value,t=>(n(),s("li",{key:t,class:"px-2 py-1 text-xs cursor-pointer hover:bg-blue-100",onMousedown:E(i=>I(t),["prevent"])},L(t),41,xe))),128))])):m("",!0)]),l("button",{class:"bg-blue-500 text-white px-3 py-1 rounded text-sm",onClick:T},"Add")])]))])}}});export{be as default};
